<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="format-detection" content="telephone=no,email=no,address=no" />
  <meta name="theme-color" content="#0b0f18" />
  <title>daugia.vin ‚Äî ƒê·∫•u gi√° VIN minh b·∫°ch tr√™n blockchain</title>

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="32x32" href="vin64.png?v=1">
  <link rel="icon" type="image/png" sizes="64x64" href="vin64.png?v=1">
  <link rel="apple-touch-icon" sizes="128x128" href="vin128.png?v=1">
  <link rel="shortcut icon" href="vin64.png?v=1">

  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <!-- ========= App Config (ƒë·ªçc b·ªüi app.js) ========= -->
  <script id="app-config" type="application/json">
  {
    "CHAIN_ID_DEC": 88,
    "CHAIN_ID_HEX": "0x58",
    "RPC_URL": "https://rpc.viction.xyz",
    "EXPLORER": "https://vicscan.xyz",
    "CONTRACTS": {
      "AUCTION": "0x1765e20ecB8cD78688417A6d4123f2b899775599",
      "VIN":     "0x941F63807401efCE8afe3C9d88d368bAA287Fac4"
    },
    "LINKS": {
      "SWAP": "https://ipfs.io/ipfs/bafybeigooqte3w5m3rok2r7c5czep2flsfeocwjpzzid3vxszdyib3rjpi",
      "SOURCE": "#"
    }
  }
  </script>

  <!-- ========= Topbar ========= -->
  <header class="topbar" role="banner">
    <div class="brand-wrap">
      <button id="menu-toggle" class="icon-btn" aria-label="M·ªü menu">‚ò∞</button>
      <img id="logo-main" src="vin128.png" alt="VIN" width="40" height="40" />
      <div class="brand">
        <h1 class="brand-title">daugia.vin</h1>
        <p class="brand-sub">N·ªÅn t·∫£ng ƒë·∫•u gi√° c√¥ng</p>
      </div>
    </div>

    <!-- √î t√¨m ki·∫øm trung t√¢m -->
    <div class="search-center" role="search">
      <input id="search-input" class="input" type="text" placeholder="T√¨m theo t√™n/m√¥ t·∫£/m√£ h·ªì s∆°/ƒë·ªãa ch·ªâ v√≠‚Ä¶" />
      <button id="btn-search" class="btn" aria-label="T√¨m ki·∫øm">üîç</button>
    </div>

    <!-- Menu ph·∫£i (desktop) -->
    <nav class="menu-right" aria-label="Menu">
      <!-- Hi·ªán khi CH∆ØA k·∫øt n·ªëi -->
      <button id="btn-connect" class="btn primary">K·∫øt n·ªëi v√≠</button>
      <span id="vin-price" class="price-tag">1 VIN = ƒêang t·∫£i...</span>
      <a class="menu-link" href="#guide">H∆∞·ªõng d·∫´n</a>
    </nav>
  </header>

  <!-- Slogan (m·∫£nh, kh√¥ng chi·∫øm ch·ªó) -->
  <section class="mission-note" role="note">
    <p>
      <strong>C√¥ng b·∫±ng ‚Ä¢ Minh b·∫°ch ‚Ä¢ T·ª± ƒë·ªông ‚Ä¢ Tr√™n Blockchain</strong><br/>
      V·∫≠n h√†nh 100% b·∫±ng h·ª£p ƒë·ªìng th√¥ng minh, kh√¥ng ai c√≥ th·ªÉ can thi·ªáp.<br/>
      <em><a href="https://docs.google.com/document/d/1MH7DPggKAGPQkdC2UuD4Afm9E_QOMbOr/edit" class="mission-link" target="_blank" rel="noopener">Xem k·ªπ h∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</a> tr∆∞·ªõc khi tham gia.</em>
    </p>
  </section>

  <!-- ========= Drawer (mobile) ========= -->
  <aside id="drawer" class="drawer" aria-hidden="true" aria-label="Menu di ƒë·ªông">
    <div class="drawer-header">
      <div class="drawer-title">Menu</div>
      <button class="icon-btn" id="drawer-close" aria-label="ƒê√≥ng">‚úï</button>
    </div>

    <!-- Search (mobile) -->
    <div class="drawer-search">
      <input id="m-search-input" class="input" type="text" placeholder="T·ª´ kh√≥a‚Ä¶" />
      <button id="m-btn-search" class="btn">T√¨m</button>
    </div>

    <div class="accordion">
      <details open>
        <summary>Truy c·∫≠p nhanh</summary>
        <div class="drawer-group">
          <button id="m-btn-connect" class="btn primary block">K·∫øt n·ªëi v√≠</button>
          <a class="menu-link block" href="#guide">H∆∞·ªõng d·∫´n</a>
          <a id="m-link-swap" class="menu-link block" href="https://ipfs.io/ipfs/bafybeigooqte3w5m3rok2r7c5czep2flsfeocwjpzzid3vxszdyib3rjpi" target="_blank" rel="noopener">Swap VIN/VIC</a>
        </div>
      </details>
    </div>
  </aside>

  <!-- ========= Main Content: ch·ªâ danh s√°ch ƒë·∫•u gi√° ========= -->
  <main class="content" role="main">
    <div id="auction-list" class="grid">
      <!-- app.js s·∫Ω render c√°c th·∫ª ƒë·∫•u gi√° -->
      <div class="skeleton-list">
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
        <div class="skeleton-card"></div>
      </div>
    </div>

    <div class="pager hide" id="pager">
      <button id="prev-page" class="btn ghost" type="button">‚Üê Tr∆∞·ªõc</button>
      <span id="page-info">Trang 1</span>
      <button id="next-page" class="btn ghost" type="button">Sau ‚Üí</button>
    </div>
  </main>

  <!-- ========= Modals ========= -->
  <div id="modal-create" class="modal" aria-hidden="true">
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="create-title">
      <div class="modal-header">
        <h3 id="create-title">T·∫°o cu·ªôc ƒë·∫•u gi√°</h3>
        <button class="icon-btn" data-close="#modal-create" aria-label="ƒê√≥ng">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="form">
          <label class="label">T√™n t√†i s·∫£n</label>
          <input id="create-name" class="input" type="text" placeholder="VD: L√¥ ƒë·∫•t, √¥ t√¥, t√†i s·∫£n kh√°c‚Ä¶" />

          <label class="label">M√¥ t·∫£</label>
          <textarea id="create-desc" class="textarea" rows="3" placeholder="Th√¥ng tin s√∫c t√≠ch, k√®m m√£ h·ªì s∆° n·∫øu c√≥"></textarea>

          <label class="label">H√¨nh ·∫£nh (URL)</label>
          <input id="create-img" class="input" type="url" placeholder="https://..." />

          <div class="row-2">
            <div>
              <label class="label">Gi√° kh·ªüi ƒëi·ªÉm (VIN)</label>
              <input id="create-start" class="input" type="number" min="0" step="0.000000000000000001" placeholder="0.0" />
            </div>
            <div>
              <label class="label">B∆∞·ªõc gi√° t·ªëi thi·ªÉu (VIN)</label>
              <input id="create-step" class="input" type="number" min="0" step="0.000000000000000001" placeholder="0.1" />
            </div>
          </div>

          <div class="row-2">
            <div>
              <label class="label">Lo·∫°i t√†i s·∫£n</label>
              <input id="create-asset-type" class="input" type="text" placeholder="VD: BƒêS, √î t√¥, Kh√°c‚Ä¶" />
            </div>
            <div>
              <label class="label">X√£/Ph∆∞·ªùng</label>
              <input id="create-ward" class="input" type="text" placeholder="VD: Ph∆∞·ªùng A, X√£ B‚Ä¶" />
            </div>
          </div>

          <label class="label">Th·ªùi ƒëi·ªÉm k·∫øt th√∫c</label>
          <input id="create-ends" class="input" type="datetime-local" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn ghost" data-close="#modal-create" type="button">Hu·ª∑</button>
        <button id="btn-create-submit" class="btn primary" type="button">T·∫°o phi√™n</button>
      </div>
    </div>
  </div>

  <div id="modal-bid" class="modal" aria-hidden="true">
    <div class="modal-dialog" role="dialog" aria-modal="true" aria-labelledby="bid-title">
      <div class="modal-header">
        <h3 id="bid-title">ƒê·∫∑t gi√°</h3>
        <button class="icon-btn" data-close="#modal-bid" aria-label="ƒê√≥ng">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="form">
          <div class="pair"><span>ƒêang d·∫´n ƒë·∫ßu:</span> <strong><span id="bid-leading">0</span> VIN</strong></div>
          <div class="pair"><span>B∆∞·ªõc t·ªëi thi·ªÉu:</span> <strong><span id="bid-step">0</span> VIN</strong></div>
          <label class="label">Gi√° b·∫°n tr·∫£ (VIN)</label>
          <input id="bid-amount" class="input" type="number" min="0" step="0.000000000000000001" placeholder="Nh·∫≠p s·ªë VIN" />
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn ghost" data-close="#modal-bid" type="button">Hu·ª∑</button>
        <button id="btn-bid-submit" class="btn primary" type="button">X√°c nh·∫≠n ƒë·∫∑t gi√°</button>
      </div>
    </div>
  </div>

  <!-- ========= Toast ========= -->
  <div id="toast" class="toast" aria-live="polite" aria-atomic="true"></div>

  <!-- Vendor -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
  <script src="app.js"></script>

  <!-- Bootstrap (kh√¥ng ƒë·ª•ng Web3) -->
  <script>
    (function () {
      const cfg = JSON.parse(document.getElementById('app-config').textContent.trim());
      const EXP = cfg.EXPLORER.replace(/\/+$/,'');
      const AUCTION = cfg.CONTRACTS.AUCTION;
      const VIN     = cfg.CONTRACTS.VIN;

      // Set explorer links
      const setHref = (id, url) => { const el = document.getElementById(id); if (el) el.href = url; };
      setHref('link-auction',      EXP + '/address/' + AUCTION);
      setHref('link-vin',          EXP + '/token/'   + VIN);
      setHref('link-expl-auction', EXP + '/address/' + AUCTION);
      setHref('link-expl-vin',     EXP + '/token/'   + VIN);

      // Mirror to mobile drawer
      ['m-link-auction','m-link-vin'].forEach((id, i) => {
        const el = document.getElementById(id);
        if (el) el.href = i === 0 ? (EXP + '/address/' + AUCTION) : (EXP + '/token/' + VIN);
      });
      if (cfg.LINKS?.SWAP) {
        setHref('link-swap', cfg.LINKS.SWAP);
        const mSwap = document.getElementById('m-link-swap');
        if (mSwap) mSwap.href = cfg.LINKS.SWAP;
      }

      // Drawer open/close
      const drawer = document.getElementById('drawer');
      document.getElementById('menu-toggle').addEventListener('click', () => {
        drawer.setAttribute('aria-hidden', drawer.getAttribute('aria-hidden') === 'true' ? 'false' : 'true');
      });
      document.getElementById('drawer-close').addEventListener('click', () => {
        drawer.setAttribute('aria-hidden', 'true');
      });

      // Desktop dropdowns
      document.querySelectorAll('.menu-item.has-sub').forEach(item => {
        const btn = item.querySelector('.menu-btn');
        btn?.addEventListener('click', (e) => {
          e.stopPropagation();
          const expanded = btn.getAttribute('aria-expanded') === 'true';
          document.querySelectorAll('.menu-item.has-sub .menu-btn[aria-expanded="true"]').forEach(b=>{
            if (b !== btn) { b.setAttribute('aria-expanded','false'); b.parentElement.classList.remove('open'); }
          });
          btn.setAttribute('aria-expanded', expanded ? 'false' : 'true');
          item.classList.toggle('open', !expanded);
        });
      });
      document.addEventListener('click', () => {
        document.querySelectorAll('.menu-item.has-sub').forEach(i => {
          i.classList.remove('open');
          const b = i.querySelector('.menu-btn'); if (b) b.setAttribute('aria-expanded','false');
        });
      });

      // Mirror search desktop <-> mobile
      const si = document.getElementById('search-input');
      const sm = document.getElementById('m-search-input');
      const sync = (from, to) => from && to && from.addEventListener('input', ()=>{ to.value = from.value; });
      sync(si, sm); sync(sm, si);

      // Mirror main actions (app.js ch·ªâ bind desktop ids)
      const map = [
        ['btn-connect','m-btn-connect'],
        ['btn-search','m-btn-search']
      ];
      map.forEach(([d,m])=>{
        const D=document.getElementById(d), M=document.getElementById(m);
        if (D && M) M.addEventListener('click', ()=> D.click());
      });
    })();
  </script>
</body>
</html>
